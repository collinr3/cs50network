{% extends "network/layout.html" %}

{% block body %}

    {% if person is not None %}
        <h3>Profile for {{ person }}</h3>
        <p>Following: {{ following }} Followed by: {{ followers }}
            {% if follow_option is not None %}
                <form action="{% url 'follow' %}?uname={{ person }}" method="post">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-primary" style="margin: 10px">{{ follow_option }}</button>
                </form>
            {% endif %}
        <hr>
    {% endif %}

    <h3>Latest Posts...</h3>
 {% for post, opinion in post_list %}
    <p style="margin: 10px"><a href="{% url 'posts' %}?uid={{ post.author.id }}">{{ post.author }}</a> {{ post.created|date:'D j-M-Y H:i' }}</p>
    <p>{{ post.text }}</p>
    {% if post.like_count == 1 %}
    <p>{{ post.like_count }} Like </p>
    {% else %}
        <p>{{ post.like_count }} Likes </p>
    {% endif %}

    {% if post.author != user %}

        {% if opinion == 'U' %}

            <a href="{% url 'like' %}?id={{ post.id }}"><span style="color: grey"><i class="fas fa-heart"></i></span></a> <a href="{% url 'read' %}?id={{ post.id }}">View</a> </p>
        {% else %}
            <a href="{% url 'like' %}?id={{ post.id }}"><span style="color: crimson"><i class="fas fa-heart"></i></span></a> <a href="{% url 'read' %}?id={{ post.id }}">View</a> </p>
        {% endif %}

    {% endif %}

    {% if post.author == user %}
        <!--TODO Need to change this url to be a post.id -->
        <a href="{% url 'edit' %}?uid={{ post.author.id }}">Edit</a>
    {% endif %}

    <hr>
    {% endfor %}

    {% if post_list.has_other_pages %}
    <nav aria-label="Page navigation example">
      <ul class="pagination">
        {% if post_list.has_previous %}
          <li class="page-item"><a class="page-link" href="?page={{ post_list.previous_page_number }}&uid={{ person.id }}">Prev</a></li>
        {% else %}
          <li class="page-item disabled"><span class="page-link">Prev</span></li>
        {% endif %}
        {% for i in post_list.paginator.page_range %}
          {% if post_list.number == i %}
          <li class="page-item active"><a class="page-link" href="?page={{ i }}&uid={{ person.id }}">{{ i }}<span class="sr-only">(current)</span></a></li>
          {% else %}
            <li class="page-item"><a class="page-link" href="?page={{ i }}&uid={{ person.id }}">{{ i }}</a></li>
          {% endif %}
        {% endfor %}
        {% if post_list.has_next %}
          <li class="page-item"><a class="page-link" href="?page={{ post_list.next_page_number }}&uid={{ person.id }}">Next</a></li>
        {% else %}
          <li class="page-item disabled"><span class="page-link">Next</span></li>
        {% endif %}
      </ul>
    </nav>
    {% endif %}

{% endblock %}
